<!DOCTYPE html>
<html>
<head>
  <title>Asher Yatzar Tracker</title>
  <script type="module">
    // Import the Firebase SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
    import { getDatabase, ref, onValue, set, get } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-database.js";

    // Your Firebase config (use your own values)
    const firebaseConfig = {
      apiKey: "AIzaSyDwOAEFociXBg8cPTFj1O2qSsnfC6pw9hU",
      authDomain: "asher-yatzar-tracker-2.firebaseapp.com",
      databaseURL: "https://asher-yatzar-tracker-2-default-rtdb.firebaseio.com",
      projectId: "asher-yatzar-tracker-2",
      storageBucket: "asher-yatzar-tracker-2.firebasestorage.app",
      messagingSenderId: "939305146617",
      appId: "1:939305146617:web:abd65c1c2e02d9048d6a28",
      measurementId: "G-P3NLW49V8X"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // Reference to your shared variable in the database
    const sharedValueRef = ref(db, 'sharedValue');

    // Grab elements from the page
    const display = document.getElementById('display');
    const button = document.getElementById('button');

    // ðŸ” Listen for realtime updates from Firebase

    onValue(sharedValueRef, (snapshot) => {
      const val = snapshot.val();
      display.textContent = val ?? '(no value yet)';
    });

    // âœï¸ Update the shared value when user clicks the button
    button.addEventListener('click', async () => {
	const snapshot = await get(sharedValueRef);
	const currentValue = Number(snapshot.val()) || 0;
        const newValue = currentValue + 1;
	set(sharedValueRef, newValue);
    });
  </script>
</head>
<body style="font-family:sans-serif; text-align:center; margin-top:5em;">
  <h1>Asher Yatzar Tracker</h1>
  <h2 id="display">(loading...)</h2>
  <button id="button">+1 Asher Yatzar</button>
</body>
</html>